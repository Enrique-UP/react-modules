<!DOCTYPE html>
<html>
<head>
  <title>Add remove class on scroll</title>
  <style type="text/css">
    *{padding:0;margin:0;box-sizing: border-box;}
    body{font-family: Arial, Helvetica, sans-serif;}
    main{width:100%;float:left;overflow: hidden;padding:0 50px;}
    main > *{width:100%;float:left;}
    header{height:300px;background: #777;}
    .left{height:1500px;background: #999;width:80%;float:left;}
    .right{height:1500px;background: #ccc;width:20%;float:left;position:relative;}
    .js_area{position: absolute;top:0;width:250px;height:200px;}
    .js_area.active{position:fixed;background: brown;transition: 0.3s linear;}
    footer{height:800px;background: #888;}
  </style>
</head>
<body>
<main>
  <header>Header</header>
  <section>
    <div class="left">Left</div>
    <div class="right">
      <div class="js_area">Fixed/Unfixed</div>
    </div>
  </section>
  <footer>Footer</footer>
</main>

<script type="text/javascript">
const navbar = document.querySelector('section .right .js_area');

var main = document.querySelector("main").offsetHeight;
console.log(main);

var header = document.querySelector("main header").offsetHeight;
console.log(header);

var footer = document.querySelector("main footer").offsetHeight;
console.log(footer);

const onScroll = () => {    
    const scroll = document.documentElement.scrollTop
      if (scroll >= header && scroll <= main - footer - 200) {
        navbar.classList.add("active");
      }
      else {
        navbar.classList.remove("active");
      }
  }
  window.addEventListener('scroll', onScroll);
</script>
</body>
</html>
